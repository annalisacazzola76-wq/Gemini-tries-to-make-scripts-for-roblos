-- Services
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")

local LocalPlayer = Players.LocalPlayer

-- Cleanup
if CoreGui:FindFirstChild("ChaosHubV3") then CoreGui.ChaosHubV3:Destroy() end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ChaosHubV3"
pcall(function() ScreenGui.Parent = CoreGui end)
if not ScreenGui.Parent then ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui") end

-- Main Frame
local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 320, 0, 480)
MainFrame.Position = UDim2.new(0.5, -160, 0.4, -240)
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
MainFrame.Active = true
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 12)
Instance.new("UIStroke", MainFrame).Color = Color3.fromRGB(255, 0, 0)

-- Title
local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 50)
Title.Text = "ULTIMATE CHAOS HUB"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.BackgroundTransparency = 1
Title.TextSize = 18

-- Scroll
local Scroll = Instance.new("ScrollingFrame", MainFrame)
Scroll.Size = UDim2.new(1, -20, 1, -70)
Scroll.Position = UDim2.new(0, 10, 0, 60)
Scroll.BackgroundTransparency = 1
Scroll.CanvasSize = UDim2.new(0, 0, 4, 0)
Scroll.ScrollBarThickness = 2
local Layout = Instance.new("UIListLayout", Scroll)
Layout.Padding = UDim.new(0, 10)
Layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- Helpers
local function createInput(placeholder)
    local i = Instance.new("TextBox", Scroll)
    i.Size = UDim2.new(0.9, 0, 0, 35)
    i.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    i.TextColor3 = Color3.fromRGB(255, 255, 255)
    i.PlaceholderText = placeholder
    i.Text = ""
    Instance.new("UICorner", i)
    return i
end

local function createBtn(text, color, func)
    local b = Instance.new("TextButton", Scroll)
    b.Size = UDim2.new(0.9, 0, 0, 35)
    b.Text = text
    b.BackgroundColor3 = color
    b.TextColor3 = Color3.fromRGB(255, 255, 255)
    b.Font = Enum.Font.GothamBold
    Instance.new("UICorner", b)
    b.MouseButton1Click:Connect(func)
    return b
end

--- BUTTONS & INPUTS ---

local GlobalID = createInput("Asset ID (Music/Image/Particle)")

-- 1. Music Player
createBtn("PLAY MUSIC ID", Color3.fromRGB(150, 0, 0), function()
    local s = workspace:FindFirstChild("ChaosSound") or Instance.new("Sound", workspace)
    s.Name = "ChaosSound"
    s.SoundId = "rbxassetid://" .. GlobalID.Text
    s.Volume = 3
    s:Play()
end)

-- 2. Particles Spam (Fixed)
createBtn("SPAM PARTICLES", Color3.fromRGB(200, 100, 0), function()
    local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if hrp then
        local p = Instance.new("ParticleEmitter", hrp)
        p.Name = "ChaosEffect"
        p.Texture = "rbxassetid://" .. (GlobalID.Text ~= "" and GlobalID.Text or "243053748")
        p.Size = NumberSequence.new(5, 10)
        p.Rate = 100
        p.Lifetime = NumberRange.new(2, 5)
    end
end)

-- 3. Rig Change (R15 to R6 Visual Hack)
createBtn("FORCE R6 VISUALS", Color3.fromRGB(100, 0, 150), function()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("Humanoid") then
        for _, v in pairs(char:GetChildren()) do
            if v:IsA("BasePart") and (v.Name:find("Left") or v.Name:find("Right") or v.Name:find("Upper") or v.Name:find("Lower")) then
                if v.Name ~= "HumanoidRootPart" then v.Transparency = 1 end -- Hide R15 parts
            end
        end
        -- Create fake R6 blocks
        local torso = Instance.new("Part", char)
        torso.Name = "ChaosEffect"
        torso.Size = Vector3.new(2, 2, 1)
        torso.Color = Color3.new(1, 1, 1)
        local weld = Instance.new("Weld", torso)
        weld.Part0 = char.HumanoidRootPart
        weld.Part1 = torso
    end
end)

-- 4. 666 Mode (Fire & Lasers)
createBtn("ACTIVATE 666 MODE", Color3.fromRGB(255, 0, 0), function()
    Lighting.Ambient = Color3.new(1, 0, 0)
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("BasePart") and v.Transparency < 1 then
            Instance.new("Fire", v).Name = "ChaosEffect"
            local s = Instance.new("SelectionBox", v)
            s.Name = "ChaosEffect"
            s.Adornee = v
            s.Color3 = Color3.new(1, 0, 0)
        end
    end
end)

-- 5. Unanchor All (Client)
createBtn("UNANCHOR MAP", Color3.fromRGB(50, 50, 50), function()
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("BasePart") then v.Anchored = false end
    end
end)

-- 6. Kick All (Client Troll)
createBtn("KICK ALL PLAYERS", Color3.fromRGB(200, 0, 0), function()
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then
            p.Character:Destroy() -- Removes them from your screen
        end
    end
end)

-- 7. Shutdown (Fake)
createBtn("SERVER SHUTDOWN", Color3.fromRGB(0, 0, 0), function()
    local g = Instance.new("ScreenGui", CoreGui)
    local f = Instance.new("Frame", g)
    f.Size = UDim2.new(1, 0, 1, 0)
    f.BackgroundColor3 = Color3.new(0, 0, 0)
    local t = Instance.new("TextLabel", f)
    t.Size = UDim2.new(1, 0, 1, 0)
    t.Text = "The server has experienced a critical error.\nDisconnected."
    t.TextColor3 = Color3.new(1, 1, 1)
    t.TextSize = 30
end)

-- 8. Cleanup
createBtn("CLEAN ALL VFX", Color3.fromRGB(80, 80, 80), function()
    Lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
    for _, v in pairs(workspace:GetDescendants()) do
        if v.Name == "ChaosEffect" or v.Name == "ChaosSound" then v:Destroy() end
    end
end)

--- Dragging Logic ---
local dragging, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true; dragStart = input.Position; startPos = MainFrame.Position
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging = false end
end)
