-- Services
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")

local LocalPlayer = Players.LocalPlayer

-- Cleanup
if CoreGui:FindFirstChild("ChaosHub_Final") then CoreGui.ChaosHub_Final:Destroy() end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ChaosHub_Final"
pcall(function() ScreenGui.Parent = CoreGui end)
if not ScreenGui.Parent then ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui") end

-- Main Frame
local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 320, 0, 520)
MainFrame.Position = UDim2.new(0.5, -160, 0.4, -260)
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
MainFrame.Active = true
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 10)
Instance.new("UIStroke", MainFrame).Color = Color3.fromRGB(255, 0, 0)

-- Title
local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 50)
Title.Text = "CHAOS HUB V5 (R6 UPD)"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.BackgroundTransparency = 1

-- Scroll
local Scroll = Instance.new("ScrollingFrame", MainFrame)
Scroll.Size = UDim2.new(1, -20, 1, -70)
Scroll.Position = UDim2.new(0, 10, 0, 60)
Scroll.BackgroundTransparency = 1
Scroll.CanvasSize = UDim2.new(0, 0, 4, 0)
Scroll.ScrollBarThickness = 2
local Layout = Instance.new("UIListLayout", Scroll)
Layout.Padding = UDim.new(0, 10)
Layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- Helpers
local function createInput(placeholder)
    local i = Instance.new("TextBox", Scroll)
    i.Size = UDim2.new(0.9, 0, 0, 35)
    i.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    i.TextColor3 = Color3.fromRGB(255, 255, 255)
    i.PlaceholderText = placeholder
    i.Text = ""
    Instance.new("UICorner", i)
    return i
end

local function createBtn(text, color, func)
    local b = Instance.new("TextButton", Scroll)
    b.Size = UDim2.new(0.9, 0, 0, 35)
    b.Text = text
    b.BackgroundColor3 = color
    b.TextColor3 = Color3.fromRGB(255, 255, 255)
    b.Font = Enum.Font.GothamBold
    Instance.new("UICorner", b)
    b.MouseButton1Click:Connect(func)
    return b
end

--- FEATURES ---

local GlobalID = createInput("Asset ID (Music/Image/Particle)")

-- 1. REAL R6 RIG CHANGE (Respawn & Change)
createBtn("RESPAWN AS R6", Color3.fromRGB(150, 0, 150), function()
    -- Client-side simulation of R6 conversion through CharacterAppearance
    local char = LocalPlayer.Character
    if char then
        local oldPos = char.PrimaryPart.CFrame
        LocalPlayer.CharacterAppearanceId = 12102550 -- R6 default reference
        char:BreakJoints() -- Force Respawn
        
        LocalPlayer.CharacterAdded:Connect(function(newChar)
            task.wait(0.5)
            newChar:SetPrimaryPartCFrame(oldPos)
        end)
    end
end)

-- 2. PARTICLES SPAM
createBtn("SPAWN PARTICLES", Color3.fromRGB(200, 100, 0), function()
    local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if hrp then
        local p = Instance.new("ParticleEmitter", hrp)
        p.Name = "ChaosVFX"
        p.Texture = "rbxassetid://" .. (GlobalID.Text ~= "" and GlobalID.Text or "243053748")
        p.Size = NumberSequence.new(5, 12)
        p.Rate = 120
    end
end)

-- 3. MUSIC PLAYER
createBtn("PLAY MUSIC ID", Color3.fromRGB(0, 120, 0), function()
    local s = workspace:FindFirstChild("ChaosSound") or Instance.new("Sound", workspace)
    s.Name = "ChaosSound"
    s.SoundId = "rbxassetid://" .. GlobalID.Text
    s.Volume = 3
    s:Play()
end)

-- 4. 666 MODE (Fire & Lasers)
createBtn("ACTIVATE 666 MODE", Color3.fromRGB(255, 0, 0), function()
    Lighting.Ambient = Color3.new(1, 0, 0)
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("BasePart") and v.Transparency < 1 then
            Instance.new("Fire", v).Name = "ChaosVFX"
            local s = Instance.new("SelectionBox", v)
            s.Name = "ChaosVFX"
            s.Adornee = v
            s.Color3 = Color3.new(1, 0, 0)
        end
    end
end)

-- 5. UNANCHOR MAP
createBtn("UNANCHOR ALL", Color3.fromRGB(60, 60, 60), function()
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("BasePart") then v.Anchored = false end
    end
end)

-- 6. KICK ALL (Client-Side)
createBtn("KICK ALL PLAYERS", Color3.fromRGB(180, 0, 0), function()
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then p:Destroy() end
    end
end)

-- 7. REAL SHUTDOWN (Disconnect)
createBtn("SHUTDOWN GAME", Color3.fromRGB(0, 0, 0), function()
    LocalPlayer:Kick("server shutdown by chaos!!!!!!!!")
end)

-- 8. CLEANUP
createBtn("CLEAN EFFECTS", Color3.fromRGB(100, 100, 100), function()
    Lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
    for _, v in pairs(workspace:GetDescendants()) do
        if v.Name == "ChaosVFX" or v.Name == "ChaosSound" then v:Destroy() end
    end
end)

--- Mobile Dragging ---
local dragging, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true; dragStart = input.Position; startPos = MainFrame.Position
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging = false end
end)
