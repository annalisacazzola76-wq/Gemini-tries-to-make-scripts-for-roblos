-- Services
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TextChatService = game:GetService("TextChatService")

local LocalPlayer = Players.LocalPlayer

-- Cleanup
if CoreGui:FindFirstChild("StarBypassV3") then CoreGui.StarBypassV3:Destroy() end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "StarBypassV3"
pcall(function() ScreenGui.Parent = CoreGui end)
if not ScreenGui.Parent then ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui") end

-- Main Frame
local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 280, 0, 180)
MainFrame.Position = UDim2.new(0.5, -140, 0.4, -90)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
MainFrame.Active = true
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 10)

local Stroke = Instance.new("UIStroke", MainFrame)
Stroke.Color = Color3.fromRGB(255, 255, 255) -- White Border
Stroke.Thickness = 2

local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Text = "STAR BYPASS ★"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamBold
Title.TextSize = 16

local ChatInput = Instance.new("TextBox", MainFrame)
ChatInput.Size = UDim2.new(0.85, 0, 0, 45)
ChatInput.Position = UDim2.new(0.075, 0, 0.3, 0)
ChatInput.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
ChatInput.PlaceholderText = "Message to Bypass..."
ChatInput.Text = ""
ChatInput.TextColor3 = Color3.fromRGB(255, 255, 255)
ChatInput.Font = Enum.Font.Gotham
Instance.new("UICorner", ChatInput)

local SendBtn = Instance.new("TextButton", MainFrame)
SendBtn.Size = UDim2.new(0.85, 0, 0, 40)
SendBtn.Position = UDim2.new(0.075, 0, 0.65, 0)
SendBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
SendBtn.Text = "SEND BYPASS"
SendBtn.Font = Enum.Font.GothamBlack
SendBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
Instance.new("UICorner", SendBtn)

--- STAR BYPASS LOGIC (★ Method) ---
local function starBypass(text)
    local result = "★"
    for i = 1, #text do
        local c = text:sub(i,i)
        if c ~= " " then
            -- Aggiunge la stella speciale dopo ogni carattere
            result = result .. c .. "★"
        else
            result = result .. "  "
        end
    end
    return result
end

local function send(msg)
    local events = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
    local remote = events and events:FindFirstChild("SayMessageRequest")
    if remote then
        remote:FireServer(msg, "All")
    else
        -- Support for New TextChatService
        local channel = TextChatService:FindFirstChild("TextChannels") and TextChatService.TextChannels:FindFirstChild("RBXGeneral")
        if channel then
            channel:SendAsync(msg)
        end
    end
end

SendBtn.MouseButton1Click:Connect(function()
    if ChatInput.Text ~= "" then
        send(starBypass(ChatInput.Text))
        ChatInput.Text = ""
    end
end)

--- Mobile Dragging Logic ---
local dragging, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true; dragStart = input.Position; startPos = MainFrame.Position
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging = false end
end)
