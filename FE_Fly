-- Services
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer

-- Cleanup
if CoreGui:FindFirstChild("FlyGUI") then CoreGui.FlyGUI:Destroy() end

local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "FlyGUI"

local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0, 150, 0, 80)
Main.Position = UDim2.new(0.1, 0, 0.5, 0)
Main.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
Instance.new("UICorner", Main)
local Stroke = Instance.new("UIStroke", Main)
Stroke.Color = Color3.fromRGB(0, 255, 100)

local Title = Instance.new("TextLabel", Main)
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Text = "FE FLY"
Title.TextColor3 = Color3.new(1,1,1)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamBold

local Toggle = Instance.new("TextButton", Main)
Toggle.Size = UDim2.new(0.8, 0, 0, 30)
Toggle.Position = UDim2.new(0.1, 0, 0.5, 0)
Toggle.Text = "Fly: OFF"
Toggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
Toggle.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", Toggle)

local flying = false
local speed = 50
local bv, bg

Toggle.MouseButton1Click:Connect(function()
    flying = not flying
    Toggle.Text = flying and "Fly: ON" or "Fly: OFF"
    Toggle.BackgroundColor3 = flying and Color3.fromRGB(0, 150, 0) or Color3.fromRGB(50, 50, 50)
    
    local char = LocalPlayer.Character
    if flying and char and char:FindFirstChild("HumanoidRootPart") then
        local hrp = char.HumanoidRootPart
        bg = Instance.new("BodyGyro", hrp)
        bg.P = 9e4
        bg.maxTorque = Vector3.new(9e9, 9e9, 9e9)
        bg.cframe = hrp.CFrame
        
        bv = Instance.new("BodyVelocity", hrp)
        bv.velocity = Vector3.new(0, 0.1, 0)
        bv.maxForce = Vector3.new(9e9, 9e9, 9e9)
        
        char.Humanoid.PlatformStand = true
        
        spawn(function()
            while flying do
                RunService.RenderStepped:Wait()
                local cam = workspace.CurrentCamera.CFrame
                local move = Vector3.new(0,0,0)
                
                if UserInputService:IsKeyDown(Enum.KeyCode.W) then move = move + cam.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.S) then move = move - cam.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.A) then move = move - cam.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.D) then move = move + cam.RightVector end
                
                bv.velocity = move * speed
                bg.cframe = cam
            end
            bv:Destroy()
            bg:Destroy()
            char.Humanoid.PlatformStand = false
        end)
    end
end)
