-- Services
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer

-- Cleanup
if CoreGui:FindFirstChild("MovementHub") then
    CoreGui.MovementHub:Destroy()
end

-- ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "MovementHub"
ScreenGui.ResetOnSpawn = false
pcall(function() ScreenGui.Parent = CoreGui end)
if not ScreenGui.Parent then ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui") end

-- Main Frame (Larger to fit new options)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 260, 0, 280)
MainFrame.Position = UDim2.new(0.5, -130, 0.4, -140)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.Active = true
MainFrame.Parent = ScreenGui

Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 12)
local MainStroke = Instance.new("UIStroke", MainFrame)
MainStroke.Color = Color3.fromRGB(0, 255, 127)
MainStroke.Thickness = 2

-- Title
local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Text = "MOVEMENT HUB"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.BackgroundTransparency = 1
Title.TextSize = 16

-- Helper function to create Inputs
local function createInput(name, placeholder, pos)
    local input = Instance.new("TextBox", MainFrame)
    input.Name = name
    input.Size = UDim2.new(0.8, 0, 0, 35)
    input.Position = pos
    input.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    input.TextColor3 = Color3.fromRGB(255, 255, 255)
    input.PlaceholderText = placeholder
    input.Text = ""
    Instance.new("UICorner", input).CornerRadius = UDim.new(0, 6)
    return input
end

local SpeedIn = createInput("SpeedIn", "WalkSpeed (Default 16)", UDim2.new(0.1, 0, 0.18, 0))
local JumpIn = createInput("JumpIn", "JumpPower (Default 50)", UDim2.new(0.1, 0, 0.33, 0))
local GravIn = createInput("GravIn", "Gravity (Default 196.2)", UDim2.new(0.1, 0, 0.48, 0))

-- Apply Button
local ApplyBtn = Instance.new("TextButton", MainFrame)
ApplyBtn.Size = UDim2.new(0.8, 0, 0, 40)
ApplyBtn.Position = UDim2.new(0.1, 0, 0.65, 0)
ApplyBtn.BackgroundColor3 = Color3.fromRGB(0, 255, 127)
ApplyBtn.Text = "APPLY CHANGES"
ApplyBtn.Font = Enum.Font.GothamBlack
Instance.new("UICorner", ApplyBtn).CornerRadius = UDim.new(0, 6)

-- Reset Button (Emergency)
local ResetBtn = Instance.new("TextButton", MainFrame)
ResetBtn.Size = UDim2.new(0.8, 0, 0, 30)
ResetBtn.Position = UDim2.new(0.1, 0, 0.82, 0)
ResetBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ResetBtn.Text = "RESET TO DEFAULT"
ResetBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ResetBtn.Font = Enum.Font.Gotham
Instance.new("UICorner", ResetBtn).CornerRadius = UDim.new(0, 6)

-- Close Button
local CloseBtn = Instance.new("TextButton", MainFrame)
CloseBtn.Size = UDim2.new(0, 30, 0, 30)
CloseBtn.Position = UDim2.new(1, -35, 0, 5)
CloseBtn.BackgroundTransparency = 1
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(255, 50, 50)
CloseBtn.TextSize = 20

--- Logic ---

local function apply()
    local char = LocalPlayer.Character
    local hum = char and char:FindFirstChild("Humanoid")
    
    if hum then
        if tonumber(SpeedIn.Text) then hum.WalkSpeed = tonumber(SpeedIn.Text) end
        if tonumber(JumpIn.Text) then 
            hum.UseJumpPower = true
            hum.JumpPower = tonumber(JumpIn.Text) 
        end
    end
    if tonumber(GravIn.Text) then workspace.Gravity = tonumber(GravIn.Text) end
end

ApplyBtn.MouseButton1Click:Connect(apply)

ResetBtn.MouseButton1Click:Connect(function()
    local char = LocalPlayer.Character
    local hum = char and char:FindFirstChild("Humanoid")
    if hum then
        hum.WalkSpeed = 16
        hum.JumpPower = 50
    end
    workspace.Gravity = 196.2
    SpeedIn.Text = ""
    JumpIn.Text = ""
    GravIn.Text = ""
end)

CloseBtn.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)

--- Drag System (Mobile Friendly) ---
local dragging, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true; dragStart = input.Position; startPos = MainFrame.Position
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)
